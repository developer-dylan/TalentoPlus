@{
    ViewData["Title"] = "Tablero";
}

<h2 class="fw-bold mb-4 fade-in">Resumen del Tablero</h2>

<div class="row g-4 fade-in mb-5">
    <div class="col-md-4">
        <div class="dash-card">
            <div class="dash-icon">
                <i class="bi bi-people"></i>
            </div>
            <div class="dash-info">
                <h3>@ViewBag.TotalEmployees</h3>
                <p>Total Empleados</p>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="dash-card">
            <div class="dash-icon" style="color: #f59e0b; background: #fef3c7;">
                <i class="bi bi-airplane"></i>
            </div>
            <div class="dash-info">
                <h3>@ViewBag.OnVacation</h3>
                <p>En Vacaciones</p>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="dash-card">
            <div class="dash-icon" style="color: #10b981; background: #d1fae5;">
                <i class="bi bi-check-circle"></i>
            </div>
            <div class="dash-info">
                <h3>@ViewBag.ActiveEmployees</h3>
                <p>Empleados Activos</p>
            </div>
        </div>
    </div>
</div>

<div class="card-soft fade-in">
    <div class="d-flex align-items-center mb-4">
        <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3 text-primary">
            <i class="bi bi-robot fs-4"></i>
        </div>
        <div>
            <h4 class="mb-1">Asistente IA</h4>
            <p class="text-muted mb-0">Haz preguntas en lenguaje natural sobre los datos de tu personal.</p>
        </div>
    </div>

    <div class="input-group mb-3">
        <input type="text" id="questionInput" class="form-control form-control-lg border-end-0"
               placeholder="ej. ¿Cuántos empleados hay en el departamento de TI?" style="border-radius: 10px 0 0 10px;">
        <button class="btn btn-primary px-4" onclick="askAI()" style="border-radius: 0 10px 10px 0;">
            Preguntar a IA
        </button>
    </div>

    <div id="aiResponse" class="alert alert-light border fade-in" style="display:none; border-radius: 10px;">
        <div class="d-flex">
            <i class="bi bi-stars text-warning me-2 fs-5"></i>
            <div id="aiResponseText"></div>
        </div>
    </div>
</div>

<script>
    function askAI() {
        var q = document.getElementById("questionInput").value;

        fetch('/Dashboard/AskAI', {
            method: 'POST',
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ question: q })
        })
        .then(res => res.json())
        .then(data => {
            let div = document.getElementById("aiResponse");
            let textDiv = document.getElementById("aiResponseText");
            
            div.style.display = "block";
            div.classList.add("fade-in");
            textDiv.innerText = data.answer;
        });
    }
</script>
